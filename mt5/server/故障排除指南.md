# MT5 äº¤æ˜“æœåŠ¡å™¨æ•…éšœæ’é™¤æŒ‡å—

## ğŸš¨ å¸¸è§é—®é¢˜è¯Šæ–­

### 1. æœåŠ¡å™¨å¯åŠ¨é—®é¢˜

#### é—®é¢˜ï¼šç«¯å£è¢«å ç”¨

```
OSError: [WinError 10048] é€šå¸¸æ¯ä¸ªå¥—æ¥å­—åœ°å€åªå…è®¸ä½¿ç”¨ä¸€æ¬¡
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :5000

# ç»“æŸå ç”¨è¿›ç¨‹
taskkill /PID <è¿›ç¨‹ID> /F

# æˆ–æ›´æ”¹ç«¯å£
# åœ¨config.yamlä¸­ä¿®æ”¹porté…ç½®
```

#### é—®é¢˜ï¼šPython ä¾èµ–ç¼ºå¤±

```
ModuleNotFoundError: No module named 'MetaTrader5'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
pip install MetaTrader5
pip install flask flask-cors
pip install pandas pytz
```

#### é—®é¢˜ï¼šé…ç½®æ–‡ä»¶é”™è¯¯

```
yaml.scanner.ScannerError: mapping values are not allowed here
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

- æ£€æŸ¥ config.yaml è¯­æ³•
- ç¡®ä¿ç¼©è¿›ä½¿ç”¨ç©ºæ ¼è€Œé Tab
- éªŒè¯ YAML æ ¼å¼æ­£ç¡®æ€§

### 2. MT5 è¿æ¥é—®é¢˜

#### é—®é¢˜ï¼šMT5 è¿æ¥å¤±è´¥

```json
{
  "error": "Failed to connect to MT5 terminal"
}
```

**è¯Šæ–­æ­¥éª¤**ï¼š

1. ç¡®è®¤ MT5 å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•
2. æ£€æŸ¥ MT5 è‡ªåŠ¨äº¤æ˜“æ˜¯å¦å¯ç”¨
3. éªŒè¯è´¦æˆ·æƒé™

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ£€æŸ¥MT5çŠ¶æ€
curl http://127.0.0.1:5000/health

# æŸ¥çœ‹è¿æ¥æ—¥å¿—
grep "MT5" mt5_server.log
```

#### é—®é¢˜ï¼šè´¦æˆ·ä¿¡æ¯è·å–å¤±è´¥

```json
{
  "error": "Failed to get account information"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. é‡æ–°ç™»å½• MT5 è´¦æˆ·
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. éªŒè¯æœåŠ¡å™¨è¿æ¥çŠ¶æ€

### 3. äº¤æ˜“æ‰§è¡Œé—®é¢˜

#### é—®é¢˜ï¼šè‡ªåŠ¨äº¤æ˜“ç¦ç”¨

```json
{
  "error": "AutoTrading disabled by client"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. åœ¨ MT5 å®¢æˆ·ç«¯ç‚¹å‡»"è‡ªåŠ¨äº¤æ˜“"æŒ‰é’®å¯ç”¨
2. æ£€æŸ¥ EA äº¤æ˜“æƒé™
3. ç¡®è®¤è´¦æˆ·ç±»å‹æ”¯æŒè‡ªåŠ¨äº¤æ˜“

#### é—®é¢˜ï¼šå¡«å……æ¨¡å¼é”™è¯¯

```json
{
  "error": "Unsupported filling mode"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ç³»ç»Ÿå·²è‡ªåŠ¨ä¿®å¤æ­¤é—®é¢˜
- é‡å¯æœåŠ¡å™¨åº”ç”¨æœ€æ–°ä¿®å¤
- æ£€æŸ¥äº¤æ˜“å“ç§æ˜¯å¦æ”¯æŒ

#### é—®é¢˜ï¼šä»“ä½å¤§å°é”™è¯¯

```json
{
  "error": "Invalid volume"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ£€æŸ¥å“ç§è§„æ ¼
curl http://127.0.0.1:5000/symbol/XAUUSD

# è°ƒæ•´ä»“ä½å¤§å°
# æœ€å°: 0.01, æœ€å¤§: æ ¹æ®è´¦æˆ·è€Œå®š
```

### 4. ç½‘ç»œè¿æ¥é—®é¢˜

#### é—®é¢˜ï¼šè¯·æ±‚è¶…æ—¶

```
requests.exceptions.ConnectTimeout
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
2. éªŒè¯ IP åœ°å€å’Œç«¯å£
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

#### é—®é¢˜ï¼šç¼–ç é”™è¯¯

```
UnicodeDecodeError: 'utf-8' codec can't decode
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# ç¡®ä¿ä½¿ç”¨UTF-8ç¼–ç 
curl -X POST http://127.0.0.1:5000/webhook \
  -H "Content-Type: text/plain; charset=utf-8" \
  -d "å¼€å¤š XAUUSD"
```

### 5. æ•°æ®è§£æé—®é¢˜

#### é—®é¢˜ï¼šä¸­æ–‡è§£æå¤±è´¥

```json
{
  "error": "Failed to parse Chinese message"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. æ£€æŸ¥å‘½ä»¤æ ¼å¼æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿ä½¿ç”¨æ”¯æŒçš„äº¤æ˜“å“ç§
3. éªŒè¯å‚æ•°æ ¼å¼

**æ­£ç¡®æ ¼å¼ç¤ºä¾‹**ï¼š

```
å¼€å¤š XAUUSD ä»“ä½=0.05 æ­¢æŸ=3350 æ­¢ç›ˆ=3370
å¹³å¤š XAUUSD ä»“ä½=0.05
å…¨å¹³ XAUUSD
å¼€å¯æ—¶é—´åŒºé—´
```

#### é—®é¢˜ï¼šJSON æ ¼å¼é”™è¯¯

```json
{
  "error": "Invalid JSON format"
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```json
// æ­£ç¡®çš„JSONæ ¼å¼
{
  "action": "buy",
  "symbol": "XAUUSD",
  "volume": 0.05,
  "sl": 3350,
  "tp": 3370
}
```

## ğŸ” è¯Šæ–­å·¥å…·

### 1. å¥åº·æ£€æŸ¥

```bash
curl http://127.0.0.1:5000/health | python -m json.tool
```

### 2. æ—¥å¿—åˆ†æ

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -n 50 mt5_server.log

# æœç´¢é”™è¯¯
grep -i "error" mt5_server.log

# æœç´¢ç‰¹å®šæ—¶é—´
grep "2025-07-25 13:" mt5_server.log

# æœç´¢äº¤æ˜“è®°å½•
grep "TRADE:" mt5_server.log
```

### 3. è¿æ¥æµ‹è¯•

```bash
# æµ‹è¯•æœåŠ¡å™¨å“åº”
curl -I http://127.0.0.1:5000/health

# æµ‹è¯•MT5è¿æ¥
python -c "
import MetaTrader5 as mt5
print('MT5 Version:', mt5.version())
if mt5.initialize():
    print('MT5 Connected')
    print('Account:', mt5.account_info())
    mt5.shutdown()
else:
    print('MT5 Connection Failed')
"
```

### 4. æ€§èƒ½ç›‘æ§

```bash
# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
tasklist | findstr python

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
wmic process where name="python.exe" get ProcessId,PageFileUsage

# æ£€æŸ¥ç½‘ç»œè¿æ¥
netstat -an | findstr :5000
```

## ğŸ› ï¸ ä¿®å¤æ­¥éª¤

### å®Œå…¨é‡ç½®æµç¨‹

1. **åœæ­¢æœåŠ¡å™¨**

   ```bash
   # Ctrl+C æˆ–å…³é—­ç»ˆç«¯
   ```

2. **æ£€æŸ¥ MT5 çŠ¶æ€**

   - ç¡®ä¿ MT5 å·²ç™»å½•
   - å¯ç”¨è‡ªåŠ¨äº¤æ˜“
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

3. **æ¸…ç†æ—¥å¿—**

   ```bash
   del mt5_server.log
   ```

4. **é‡å¯æœåŠ¡å™¨**

   ```bash
   python app.py
   ```

5. **éªŒè¯åŠŸèƒ½**
   ```bash
   curl http://127.0.0.1:5000/health
   ```

### é…ç½®é‡ç½®

```bash
# å¤‡ä»½å½“å‰é…ç½®
copy config.yaml config.yaml.bak

# ä½¿ç”¨é»˜è®¤é…ç½®
# æ£€æŸ¥config.yamlä¸­çš„åŸºæœ¬è®¾ç½®
```

## ğŸ“Š ç›‘æ§è„šæœ¬

### PowerShell ç›‘æ§è„šæœ¬

```powershell
# æœåŠ¡å™¨çŠ¶æ€ç›‘æ§
function Test-MT5Server {
    try {
        $response = Invoke-RestMethod -Uri "http://127.0.0.1:5000/health" -TimeoutSec 5
        if ($response.status -eq "healthy") {
            Write-Host "âœ… æœåŠ¡å™¨æ­£å¸¸" -ForegroundColor Green
            Write-Host "è´¦æˆ·: $($response.account_info.login)"
            Write-Host "ä½™é¢: $($response.account_info.balance) USD"
            return $true
        }
    }
    catch {
        Write-Host "âŒ æœåŠ¡å™¨å¼‚å¸¸: $($_.Exception.Message)" -ForegroundColor Red
        return $false
    }
}

# å¾ªç¯ç›‘æ§
while ($true) {
    Clear-Host
    Write-Host "=== MT5æœåŠ¡å™¨ç›‘æ§ ===" -ForegroundColor Cyan
    Write-Host "æ—¶é—´: $(Get-Date)"

    if (Test-MT5Server) {
        Write-Host "ç³»ç»Ÿè¿è¡Œæ­£å¸¸" -ForegroundColor Green
    } else {
        Write-Host "éœ€è¦æ£€æŸ¥ç³»ç»ŸçŠ¶æ€" -ForegroundColor Yellow
    }

    Start-Sleep -Seconds 30
}
```

## ğŸ“ è·å–æ”¯æŒ

### è‡ªåŠ©è¯Šæ–­æ¸…å•

- [ ] æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼Ÿ
- [ ] MT5 å®¢æˆ·ç«¯æ˜¯å¦å·²ç™»å½•ï¼Ÿ
- [ ] è‡ªåŠ¨äº¤æ˜“æ˜¯å¦å·²å¯ç”¨ï¼Ÿ
- [ ] ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ï¼Ÿ
- [ ] å‘½ä»¤æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] æ—¶é—´åŒºé—´æ˜¯å¦å·²å¼€å¯ï¼Ÿ

### æ—¥å¿—æ”¶é›†

åœ¨æŠ¥å‘Šé—®é¢˜æ—¶ï¼Œè¯·æä¾›ï¼š

1. é”™è¯¯ä¿¡æ¯æˆªå›¾
2. ç›¸å…³æ—¥å¿—ç‰‡æ®µ
3. é…ç½®æ–‡ä»¶å†…å®¹
4. æ“ä½œæ­¥éª¤æè¿°

### æµ‹è¯•ç¯å¢ƒ

å»ºè®®åœ¨æ¨¡æ‹Ÿè´¦æˆ·ä¸Šæµ‹è¯•ï¼š

1. é™ä½é£é™©
2. éªŒè¯åŠŸèƒ½
3. ç†Ÿæ‚‰æ“ä½œ
4. è°ƒè¯•é—®é¢˜

---

ğŸ”§ **è®°ä½**: å¤§å¤šæ•°é—®é¢˜éƒ½å¯ä»¥é€šè¿‡é‡å¯æœåŠ¡å™¨å’Œæ£€æŸ¥ MT5 è¿æ¥çŠ¶æ€æ¥è§£å†³ï¼
